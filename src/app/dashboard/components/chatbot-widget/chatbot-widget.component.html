<div class="chatbot-container">
  <div class="chatbot-fab" (click)="toggle()">
    <span class="chatbot-fab-icon">ðŸ’¬</span>
  </div>

  <div class="chatbot-panel" *ngIf="isOpen">
    <div class="chatbot-header">
      <div class="chatbot-header-title">Asistente</div>
      <button class="chatbot-header-close" type="button" (click)="toggle()">âœ•</button>
    </div>

    <div class="chatbot-messages">
      <div
        *ngFor="let msg of messages; trackBy: trackByIndex"
        class="chatbot-message"
        [ngClass]="{
          'chatbot-message-user': msg.role === 'user',
          'chatbot-message-assistant': msg.role === 'assistant'
        }"
      >
        <div class="chatbot-message-bubble">
          {{ msg.content }}
        </div>
      </div>

      <div *ngIf="isLoading" class="chatbot-message chatbot-message-assistant">
        <div class="chatbot-message-bubble chatbot-message-loading">
          Escribiendoâ€¦
        </div>
      </div>
    </div>

    <div class="chatbot-input-area">
      <textarea
        [(ngModel)]="inputValue"
        class="chatbot-input"
        rows="1"
        placeholder="Escribe tu mensaje..."
        (keydown)="handleKeyDown($event)"
      ></textarea>
      <button
        class="chatbot-send-button"
        type="button"
        [disabled]="isLoading || !inputValue.trim()"
        (click)="sendMessage()"
      >
        âž¤
      </button>
    </div>
  </div>
</div>
